<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Documentaci√≥n Interna - Sistema de Tracking de Art√≠culos - Connectas</title>

    <!-- Google Fonts: Inter para mejor legibilidad -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Prism.js para resaltar sintaxis en fragmentos de c√≥digo -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

    <style>
      body {
        font-family: 'Inter', sans-serif;
        max-width: 900px;
        margin: 40px auto;
        padding: 0 20px;
        line-height: 1.6;
        color: #333;
      }
      h1 {
        color: #2c3e50;
        font-size: 2.5em;
        margin-bottom: 20px;
      }
      h2 {
        color: #34495e;
        font-size: 1.8em;
        margin-top: 40px;
        margin-bottom: 15px;
      }
      h3 {
        color: #34495e;
        font-size: 1.4em;
        margin-top: 30px;
        margin-bottom: 10px;
      }
      .info-box {
        background: #e8f5e9;
        border-left: 4px solid #4caf50;
        padding: 20px;
        margin: 30px 0;
      }
      .warning-box {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 20px;
        margin: 30px 0;
      }
      .code-box {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        padding: 15px;
        overflow-x: auto;
        margin: 20px 0;
        border-radius: 4px;
      }
      .code-box pre {
        margin: 0;
        font-size: 14px;
        line-height: 1.4;
      }
      ul,
      ol {
        margin: 15px 0;
      }
      li {
        margin-bottom: 8px;
      }
      a {
        color: #007bff;
        text-decoration: none;
        font-weight: 700;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>üìä Documentaci√≥n Interna - Sistema de Tracking de Art√≠culos</h1>
    <p><em>Versi√≥n 1.3.0 - Para uso interno de Connectas</em></p>

    <div class="info-box">
      <h2>üéØ Prop√≥sito</h2>
      <p>
        Esta documentaci√≥n explica el funcionamiento interno del sistema de tracking de art√≠culos compartidos por medios
        aliados. Cubre c√≥mo el script env√≠a datos a Google Analytics (GA), la configuraci√≥n necesaria para reportes y
        los 3 formularios b√°sicos de reportes implementados.
      </p>
    </div>

    <h2>üîß C√≥mo Funciona el Script</h2>
    <p>
      El script <code class="language-html">connectas-analytics.js</code> es un tracker as√≠ncrono que se inserta en las
      p√°ginas de art√≠culos de medios aliados. Su funcionamiento es el siguiente:
    </p>
    <ol>
      <li>
        <strong>Carga As√≠ncrona:</strong> El script se carga con el atributo <code class="language-html">async</code>,
        por lo que no bloquea la renderizaci√≥n de la p√°gina.
      </li>
      <li>
        <strong>Detecci√≥n Autom√°tica Completa:</strong> El script detecta autom√°ticamente todos los datos necesarios:
        <ul>
          <li><strong>Partner (medio aliado):</strong> Extrae el nombre del medio desde el dominio del sitio web (ej: vistazo.com ‚Üí "Vistazo", eltiempo.com.co ‚Üí "Eltiempo")</li>
          <li><strong>Article ID:</strong> Toma autom√°ticamente el ID del art√≠culo desde el pathname de la URL (ej: "/trump-derechos-humanos-2024" ‚Üí "trump-derechos-humanos-2024")</li>
        </ul>
        <p>
          <strong>Retrocompatibilidad:</strong> Si se incluye el par√°metro <code>?partner=</code> en la URL del script, se usa ese valor en lugar de la detecci√≥n autom√°tica.
        </p>
      </li>
      <li>
        <strong>Captura de Datos Autom√°tica:</strong>
        <ul>
          <li>URL actual de la p√°gina.</li>
          <li>T√≠tulo de la p√°gina (<code class="language-html">document.title</code>).</li>
          <li>Referrer (de d√≥nde viene el usuario).</li>
          <li>Timestamp de la visita.</li>
        </ul>
      </li>
      <li>
        <strong>Cargar Google Analytics:</strong> Si no est√° presente, carga autom√°ticamente Google Analytics de
        Connectas (GA4) en el sitio del aliado.
      </li>
      <li>
        <strong>Env√≠o a GA:</strong> Env√≠a un evento personalizado a Google Analytics de Connectas usando
        <code>gtag</code>.
      </li>
    </ol>

    <div class="code-box">
      <pre><code class="language-javascript">// Ejemplo de evento enviado a GA
gtag('event', 'syndicated_article_view', {
  article_id: window.location.pathname, // Ej: '/trump-derechos-humanos-2024'
  partner_name: 'El Espectador',
  embed_url: window.location.href,
  page_title: document.title,
  page_referrer: document.referrer
});</code></pre>
    </div>

    <h2>‚öôÔ∏è Configuraci√≥n Actual en GA de Connectas</h2>
    <p>La configuraci√≥n ya est√° implementada en Google Analytics con:</p>
    <ul>
      <li><strong>Evento personalizado:</strong> <code class="language-html">syndicated_article_view</code></li>
      <li>
        <strong>Dimensiones:</strong> <code class="language-html">article_id</code>,
        <code class="language-html">partner_name</code>, <code class="language-html">embed_url</code>,
        <code class="language-html">page_title</code>, <code class="language-html">page_referrer</code>
      </li>
      <li><strong>M√©tricas utilizadas en reportes:</strong> Event count, engagement rate, total users.</li>
    </ul>

    <div class="warning-box">
      <h3>‚ö†Ô∏è Importante</h3>
      <p>
        El script carga Google Analytics de Connectas autom√°ticamente en el sitio del aliado, incluso si no tienen GA
        configurado. Esto asegura que los eventos se env√≠en correctamente a nuestra cuenta de GA.
      </p>
    </div>

    <h2>üìà Reportes B√°sicos Implementados</h2>
    <p>
      Se han creado 3 formularios b√°sicos para generar reportes desde GA. Estos se basan en consultas a la API de GA o
      vistas personalizadas.
    </p>

    <h3>1. Vista General de Art√≠culos</h3>
    <p>Muestra un resumen de todas las vistas de art√≠culos, agrupadas por art√≠culo y medio aliado.</p>
    <ul>
      <li><strong>M√©tricas:</strong> Event count, total users.</li>
      <li><strong>Dimensiones:</strong> Art√≠culo (ID), Medio Aliado.</li>
      <li><strong>Uso:</strong> Para obtener una visi√≥n general del rendimiento de todos los art√≠culos compartidos.</li>
    </ul>

    <h3>2. Reporte por Medio Aliado Top</h3>
    <p>Ranking de medios aliados por n√∫mero de vistas totales.</p>
    <ul>
      <li><strong>M√©tricas:</strong> Event count, total users, engagement rate.</li>
      <li><strong>Dimensiones:</strong> Medio Aliado.</li>
      <li><strong>Uso:</strong> Identificar los aliados m√°s activos y medir el alcance por medio.</li>
    </ul>

    <h3>3. Reporte Detallado: URLs de Embed</h3>
    <p>Lista detallada de todas las URLs donde se ha embedido el script, con m√©tricas por p√°gina.</p>
    <ul>
      <li><strong>M√©tricas:</strong> Event count por URL, total users.</li>
      <li><strong>Dimensiones:</strong> URL completa, Art√≠culo (ID), Medio Aliado.</li>
      <li>
        <strong>Uso:</strong> Para auditor√≠a y verificaci√≥n de d√≥nde se est√° usando el script, y analizar el tr√°fico por
        fuente.
      </li>
    </ul>

    <h2>üõ†Ô∏è Mantenimiento y Actualizaciones</h2>
    <ul>
      <li>
        <strong>Versionado:</strong> Mantener versiones del script en el repo (ej: v1.2.0) para tracking de cambios.
      </li>
      <li><strong>Monitoreo:</strong> Revisar logs de GA regularmente para detectar anomal√≠as.</li>
      <li>
        <strong>Actualizaciones:</strong> Si se cambia la estructura de par√°metros, notificar a aliados y actualizar
        documentaci√≥n.
      </li>
      <li>
        <strong>Seguridad:</strong> Asegurar que el script no exponga datos sensibles; solo env√≠a informaci√≥n p√∫blica.
      </li>
    </ul>

    <h2>üìû Soporte</h2>
    <p>
      Para dudas t√©cnicas o configuraciones, contactar a
      <a href="mailto:johnserranodev@gmail.com" target="_blank">John Serrano</a>. Esta documentaci√≥n se actualiza con
      cada nueva versi√≥n del sistema.
    </p>
  </body>
</html>
